---
title: '"If I have seen further it is by standing on the shoulders of Giants."'
author: -Sir Isaac Newton
output: 
  html_document:
    toc: no
    code_folding: hide
---

<style>
#header {
  background: black url('images/diverge_and_me.JPG') center no-repeat;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  color: white;
  height: 200px;
position: relative; /* child absolute */
  margin: 0 -9999rem;
  /* add back section padding value */
  padding: .25rem 9999rem;

}
</style>
<div class="head-bar"></div>

<br>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
library(DT)
```

This is my contribution to the fields of data science, business analytics, information technology, and variations on those themes.

```{r blog_df}

# here I manually define which blog posts to include
blog_df <- data.frame(
  filename = c("create_interesting_datasets"
               ,"ifelse_NA_trap"
               ,"building_this_site"
               ,"ed_api"
               ,"monty_hall")
)
# eventually, I will read all .rmd files in main dir
  # and exclude non-blog posts because blog posts will 
    # quickly outweigh non-blog posts

# pull some text from each post for a content sample
blog_df$intros <- sapply(
  paste0(blog_df$filename,".Rmd"),function(x){
    paste0(substr(gsub(".*##",
     "",
     paste(readLines(x)[1:50],collapse = " "),
     perl = TRUE
    ),
    1,70)," ...")
    }
  )

# identify metadata
blog_df$created_at <- as.Date(file.info(paste0(blog_df$filename,".html"))$ctime)
blog_df$updated_at <- as.Date(file.info(paste0(blog_df$filename,".html"))$mtime)
blog_df$size <- file.info(paste0(blog_df$filename,".Rmd"))$size
blog_df$lines <- sapply(
  paste0(blog_df$filename,".Rmd"),function(x) blog_df$filename = length(readLines(x)))

# extract post titles
blog_df$titles <- sapply(
  paste0(blog_df$filename,".Rmd"),function(x){
    gsub('"',
         "",
         gsub("title: ",
           "",
           readLines(x)[2]
          )
    )
    }
  )

#wrap filename in raw html
#use post title as visible text
blog_df$filename <- paste0("<a href='",blog_df$filename,".html' target='_blank'>",blog_df$titles,"</a>")

# no longer need plain text titles
blog_df$titles <- NULL

blog_df <- dplyr::arrange(blog_df,dplyr::desc(created_at))

# define formate for header
col_format <- JS(
  "function(settings, json) {",
  "$(this.api().table().header()).css({'background-color': '#252525', 'color': '#FFFFFF'});",
  "}")

datatable(blog_df
          ,escape = FALSE
          ,rownames=FALSE
          ,colnames = c('Title',
                        'Content Snippet',
                       'Created At',
                       'Updated At',
                       'Post Size (bytes)',
                       'Post Length (lines)')
          ,options=list(
            initComplete = col_format,
            pageLength=25,
            columnDefs = list( # center all but first column
              list(className = 'dt-center',targets=3:ncol(blog_df)-1)), 
            dom = 'frtpB'
          )) %>%
      formatStyle(
        'size',
        background = styleColorBar(range(0,max(blog_df$size)), 'orange'),
        backgroundSize = '98% 75%',
        backgroundRepeat = 'no-repeat',
        backgroundPosition = 'left') %>%
        formatStyle(
        'lines',
        background = styleColorBar(range(0,max(blog_df$lines)), 'orange'),
        backgroundSize = '98% 75%',
        backgroundRepeat = 'no-repeat',
        backgroundPosition = 'left') %>%
      formatStyle(columns = "filename", 
              color = 'black',
              fontWeight = 'bold')

```



