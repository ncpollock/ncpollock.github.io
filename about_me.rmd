---
title: '"If you understood everything I said, you’d be me."'
author: -Miles Davis
output: 
  html_document:
    toc: no
    code_folding: none
---

<style>
#header {
  background: url('images/main_banner_distort_blue.JPG') center no-repeat;
  background-size: cover;
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  color: white;
  text-align: center;
  height: 200px;
  position: relative;
  margin: 0 -30rem;
  padding: .25rem 0;
}
</style>
<br>

I'm excited about Data: extracting, processing, analyzing, reporting, dashboarding, and everything in between. For the past `r round(as.numeric(difftime(Sys.Date(),as.Date("2016-09-28"),unit="weeks"))/52.25,2)` years, R has been my tool of choice. Nevertheless, I have experience with a variety of sowftware, programming languages, and IT project types. You can learn more about me via the following resources:

* <a href="np_cv.pdf" target="_blank"> My Curriculum Vitae (aka my fancy resume) </a>
* <a href="https://www.linkedin.com/in/noah-pollock-5b5804157/" target="_blank"> LinkedIn </a>
* <a href="https://github.com/ncpollock/" target="_blank"> GitHub </a>


```{r setup, include=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = FALSE,message=FALSE,warning=FALSE)
library(leaflet)
library(highcharter)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)

# include font-awesome icons
htmltools::tagList(rmarkdown::html_dependency_font_awesome())

color_temp <- c("#ffa500","#1a6ecc", "#434348", "#90ed7d","#323232","#000000")


thm <- 
  hc_theme(
    colors = color_temp,
    chart = list(
      backgroundColor = "transparent",
      style = list(fontFamily = "Source Sans Pro")
    ),
    xAxis = list(
      gridLineWidth = 1
    )
  )

cv_df <- read.csv('cv_df.csv',
                  stringsAsFactors = FALSE,
                  na.strings = "") %>%
  mutate(date_end = as.Date(date_end),
         date_start = as.Date(date_start))

```

## Fun with My CV {.tabset data-width=400}

Mostly for fun, I also recreated pieces of my CV in different formats. Although, they're not all practical and may be hardly legible (e.g., ggplot2 CV needs a lot of work).


### Dashboard

```{r education, results='asis'}

tdata <- cv_df %>% 
  filter(section=="Education")

ed_tiles <- ""
for(i in unique(tdata$experience)){

ed_tiles <- paste0(
  ed_tiles,
  '<div class="col-md-4">',
  '<div class="well">',
  '<p style="text-align:center;padding: 15px 0; height:130px;font-size: x-large;"><strong>',i,'</strong></p></div></div>')

}

cat(
  '<div class="panel panel-primary">
<div class="panel-heading">
<h3 class="panel-title"><strong><i class="fa fa-graduation-cap"></i> Education</strong></h3>
</div>
<div class="panel-body">',
ed_tiles,
'</div></div>')

```


<div class="panel panel-primary">
<div class="panel-heading">
<h3 class="panel-title"><strong><i class="fa fa-user-plus"></i> Skillset Refined through Work Experience</strong></h3>
</div>
<div class="panel-body">
```{r skills}

pdata <- cv_df %>%
  filter(section=="Skills") %>%
  mutate(date_end = if_else(is.na(date_end),Sys.Date(),date_end),
         Months = (interval(as.Date(date_start),as.Date(date_end)) %/% months(1)))

# create side-by-side bar charts for each institution type
lapply(unique(pdata$category),function(skill_cat){
  
  # set each  chart with different color bars
  color_select = color_temp[
    (pdata %>% distinct(category) %>% mutate(index = 1:n()) %>% filter(category==skill_cat))$index
  ]
  
  pdata %>%
    arrange(desc(Months)) %>%
    filter(category == skill_cat) %>%
    select(experience,Months) %>%
    hchart("bar",hcaes(x="experience",y="Months"),color=color_select) %>%
    hc_add_theme(thm) %>%
    hc_title(text = skill_cat) %>%
      hc_tooltip(formatter = JS("function(){
                            return (this.point.name + '<br>' + this.y + ' Months')
                            }")
  ) %>%
    hc_xAxis(title = NA)
}) %>%
  hw_grid(rowheight = 400,
          ncol = length(unique(pdata$category)))
# ncol = ceiling(length(unique(pdata$category))/2)
```  
</div></div>

<div class="panel panel-primary">
<div class="panel-heading">
<h3 class="panel-title"><strong><i class="fa fa-microphone"></i> Presentations</strong></h3>
</div>
<div class="panel-body">
<div class="row">
  <div class="col-md-9">
```{r present_map}
pdata <- cv_df %>%
  filter(section == "Presentations") %>%
  group_by(lat,lon) %>%
  summarise(Count = n(),
            tooltip = paste(experience,collapse = "<br><br>"))
  
leaflet() %>% 
  addTiles() %>%
  addCircleMarkers(
    data = pdata,
    lat = ~lat, lng = ~lon,
    color = "blue",
    weight = 1,
    fillOpacity = .6,
    radius = ~(Count*3),
    stroke = FALSE,
    popup = ~paste0("Presentations: ",Count,"<br>",
                   tooltip),
    labelOptions = labelOptions(
    style = list("font-weight" = "normal", padding = "3px 8px"),
    textsize = "15px",
    direction = "auto"))
```
  </div>
  <div class="well">
<p style="text-align:center;padding: 15px 0; height:130px;font-size: x-large;"><strong>Total Presentations
<br><br>
`r cv_df %>% filter(section == "Presentations") %>% nrow()`
</strong></p>
</div></div>
</div></div>

### ggplot2
It needs some work (e.g., vertical spacing adjustments), but I hope it conveys my passion (obsession?) for coding in R.

First, I read in a CSV file containing some examples from my CV. I reshape and mutate the file in a few ways to make it easier to plot. For example, I add line breaks via `str_wrap()` and then I adjust the vertical width of points depending on the number of lines wrapped.

```{r cv_df_plot, fig.width=8.5, fig.height=25,fig.align='center'}

line_length <- 110

cv_df <- read.csv('cv_df.csv',
                  stringsAsFactors = FALSE,
                  na.strings = "") %>%
  filter(include == TRUE) %>%
  # arrange section the order it appears in dataframe
  mutate(section = factor(section, levels = unique(section)),
         date_end = as.Date(date_end),
         month = lubridate::month(date_end
                                  ,label=TRUE
                                  ,abbr=FALSE),
         year = lubridate::year(date_end)) %>% 
  mutate_at(.vars = vars(experience, point_1, point_2, point_3),
           .funs = funs(stringr::str_wrap(.,width=line_length))) %>%
  group_by(section)
  
cv_df <- cv_df %>%
  #adjust for number of lines
  inner_join(cv_df %>%
      gather(line_type,text,-section,-date_start,-date_end,-month,-year) %>%
      filter(!is.na(text)) %>%
      summarise(wraps = sum(floor(nchar(text)/line_length)),
        n = n()),
    by = "section") %>%
  # adjust for wrapped text adding new lines
    # need to do better and evenly space each cluster of lines
  mutate(y = 1:n()*10+wraps,
         y_point_1 = ifelse(is.na(point_1),NA,y),
         y_point_2 = ifelse(is.na(point_2),NA,y),
         y_point_3 = ifelse(is.na(point_3),NA,y))

ggplot(cv_df,aes(x=1,y=y)) +
  geom_text(aes(label=experience),hjust=0) +
  geom_text(aes(label=date_end,x=250),hjust=1) +
  
  #bullets
  geom_point(aes(x=5,y=y_point_1-2.5)) +
    geom_text(aes(label=point_1,x=10,y=y-2.5),hjust=0,size=3) +
  geom_point(aes(x=5,y=y_point_2-5)) +
    geom_text(aes(label=point_2,x=10,y=y-5),hjust=0,size=3) +
  geom_point(aes(x=5,y=y_point_3-7.5)) +
    geom_text(aes(label=point_3,x=10,y=y-7.5),hjust=0,size=3) +
  
  # to stretch canvas
  geom_point(aes(y=y+(line_length/10/n)),color="transparent") +
  
  # sections
  facet_grid(section~.,switch = 'y',scales = 'free_y',space = "free_y") + 
  
  scale_x_continuous(limits = c(1,250)) +
  
  ggtitle("Noah C. Pollock") +
  
  theme(panel.background = element_blank(),
        panel.border = element_rect(color='black',fill=NA),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(),
        axis.line = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        strip.background = element_rect(colour="#323232", fill='#323232'),
        strip.text = element_text(color="white"),
        plot.title = element_text(hjust = 0.5))


```


```{r sandbox, echo=FALSE, warning=FALSE, include=FALSE,eval=FALSE}

line_length <- 110

cv_df <- read.csv('cv_df.csv',
                  stringsAsFactors = FALSE,
                  na.strings = "") %>%
  # arrange section the order it appears in dataframe
  mutate(section = factor(section, levels = unique(section)),
         date_end = as.Date(date_end),
         month = lubridate::month(date_end
                                  ,label=TRUE
                                  ,abbr=FALSE),
         year = lubridate::year(date_end)) %>% 
  mutate_at(.vars = vars(experience, point_1, point_2, point_3),
           .funs = funs(stringr::str_wrap(.,width=line_length))) %>%
    # gather(line_type,text,-section,-date_end,-month,-year) %>%
    # mutate(line_type =  factor(line_type, levels = rev(c("experience","point_1","point_2","point_3")))) %>%
    # slice(match(rev(c("experience","point_1","point_2","point_3")), line_type)) %>% # custome sort order
  group_by(section)
  # arrange(line_type) %>%
  # mutate(y = 1:n()*10,
  #        y = ifelse(is.na(text),NA,y)) %>%
  # ungroup()
  
  #,-y,-y_point_1,-y_point_2,-y_point_3
  
cv_df <- cv_df %>%
  #adjust for number of lines
  inner_join(cv_df %>%
      gather(line_type,text,-section,-date_start,-date_end,-month,-year) %>%
      filter(!is.na(text)) %>%
      summarise(wraps = sum(floor(nchar(text)/line_length)),
        n = n()),
    by = "section") %>%
  #adjust for wrapped text adding new lines
  #need to do this!
  # y = 1:n()*(n+wraps)
  mutate(y = 1:n()*10,
         y_point_1 = ifelse(is.na(point_1),NA,y),
         y_point_2 = ifelse(is.na(point_2),NA,y),
         y_point_3 = ifelse(is.na(point_3),NA,y))


# try lag/lead to adjust distances for text that wraps

 #mutate case_when for dates on sections



# or build cv points in R instead ###########
# easier to put the essentials in a .csv file
# cv_df <- data.frame(
#   section = c(
#     rep("Education",3)
#     ,rep("Career",4)
#     ,rep("Acheivements",3)),
#   experience = c(
#     "Bachelors of Arts in Psychology",
#     "Masters of Science in Psychology",
#     "Masters of Science in Information Technology Management",
#     
#     "Research Assistant",
#     "Data Transfer Specialist",
#     "Research Area Specialist Intermediate",
#     "Assistant Director of Assessment",
#     
#     "Chair, Michigan Association for Institutional Research",
#     "Oakland University Advancement Core Value Award for Teamwork and Community",
#     "John Steele Grant, Midwest Association of Colleges and Employers"),
#   date_end = c("2013-04-01",
#            "2015-04-01",
#            "2020-04-01",
#            
#            "2015-10-15",
#            "2016-02-15",
#            "2016-09-26",
#            "2099-09-09",
#            
#            "2020-01-01",
#            "2018-01-01",
#            "2018-01-01"),
#   point_1 = c("Departmental Honors",
#               "Thesis: Is “Average” Feedback Threatening? Performance Feedback and the Stress-Buffering Model of High Self-Esteem",
#               "Concentration in Business Analytics",
#               "Programmed automated analytic processes using SPSS syntax and R",
#               "Developed user-friendly databases connected to Banner (Ellucian ERP System)",
#               "Coordinated with multiple departments to manage data definitions and integrity",
#               "Collect, clean, analyze, and report on post-graduation success data",
#               rep(NA,3)),
#   point_2 = c("Minor in Philosophy",
#               rep(NA,2),
#               "Drafted reports to summarize institutional data",
#               "Explored data relevant to transfer student success and articulation",
#               "Satisfied federal and state government reporting requirements",
#               "Supervise IT Interns and collaborate with departments across campus",
#               rep(NA,3)),
#   point_3 = c(rep(NA,3),
#               "Cleaned, organized, and analyzed datasets with over 1 million rows and 100 columns",
#               "Solved technical challenges using MS Access, SQL*Plus, VBA, and Batch scripting",
#               "Extracted, analyzed, and reported on student success and program review data",
#               "Identify and report on key performance indicators within the department",
#               rep(NA,3))
# ) # continue rest of code here...
##########


# ggplot(cv_df,aes(x=1,y=y)) +
#   geom_text(aes(label=experience),hjust=0) +
#   geom_text(aes(label=date_end,x=250),hjust=1) +
#   
#   #bullets
#   geom_point(aes(x=5,y=y_point_1-2.5)) +
#     geom_text(aes(label=point_1,x=10,y=y-2.5),hjust=0,size=3) +
#   geom_point(aes(x=5,y=y_point_2-5)) +
#     geom_text(aes(label=point_2,x=10,y=y-5),hjust=0,size=3) +
#   geom_point(aes(x=5,y=y_point_3-7.5)) +
#     geom_text(aes(label=point_3,x=10,y=y-7.5),hjust=0,size=3) +
#   
#   geom_point(aes(y=y+(line_length/10/n)),color="transparent") +
#   
#   facet_grid(section~.,switch = 'y',scales = 'free_y',space = "free_y") + 
#   # facet_wrap(~section,ncol=1) + # more traditional section headers
#   
#   # scale_y_continuous(breaks = seq(0,nrow(cv_df)+1,by=.5)
#   #                    ,minor_breaks = seq(.25,nrow(cv_df)+1,by=1)
#   #                    # ,minor_breaks = seq(0,nrow(cv_df)+1,by=.1)
#   #                    ,limits = c(0.5,round((nrow(cv_df)+1)/length(unique(cv_df$section)),1)
#   #                                )) +
#   
#   scale_x_continuous(limits = c(1,250)) +
#   ggtitle("Noah C. Pollock") +
#   # expand_limits(x = 0.25, y = 0.25) +
#   theme(panel.background = element_blank(),
#         panel.border = element_rect(color='black',fill=NA),
#         panel.grid.major.y = element_blank(),
#         # panel.grid.minor.y = element_line(color="gray"),
#         panel.grid.minor.y = element_blank(),
#         axis.line = element_blank(),
#         axis.text = element_blank(),
#         axis.ticks = element_blank(),
#         axis.title = element_blank(),
#         strip.background = element_rect(colour="#323232", fill='#323232'),
#         strip.text = element_text(color="white"),
#         plot.title = element_text(hjust = 0.5))

# sandbox
# 
# ggplot(cv_df,aes(x=1,y=y)) +
#   geom_text(data=cv_df %>%
#               filter(line_type=="experience"),aes(label=text),hjust=0) +
#   geom_text(data=cv_df %>%
#               filter(line_type=="experience"),aes(label=date_end,x=250),hjust=1) +
#   
#   #bullets
#   geom_point(data=cv_df %>%
#               filter(line_type!="experience"),aes(x=5,color=line_type)) +
#     geom_text(data=cv_df %>%
#               filter(line_type!="experience"),aes(label=text,x=10,color=line_type),hjust=0,size=3) +
#   # geom_point(aes(x=5,y=y_point_2-4)) +
#   #   geom_text(aes(label=point_2,x=10,y=y-4),hjust=0,size=3) +
#   # geom_point(aes(x=5,y=y_point_3-6)) +
#   #   geom_text(aes(label=point_3,x=10,y=y-6),hjust=0,size=3) +
#   
#   facet_grid(section~.,switch = 'y',scales = 'free_y') + 
#   # facet_wrap(~section,ncol=1) + # more traditional section headers
# 
#   scale_x_continuous(limits = c(1,250)) +
#   ggtitle("Noah c. Pollock") +
#   # expand_limits(x = 0.25, y = 0.25) +
#   theme(panel.background = element_blank(),
#         panel.border = element_rect(color='black',fill=NA),
#       panel.grid.major.y = element_blank(),
#       # panel.grid.minor.y = element_line(color="gray"),
#       panel.grid.minor.y = element_blank(),
#       
#       # axis.line = element_line(colour="black"),
#       axis.line = element_blank(),
#       axis.text = element_blank(),
#       axis.ticks = element_blank(),
#       axis.title = element_blank(),
#       strip.background = element_rect(colour="#323232", fill='#323232'),
#       strip.text = element_text(color="white"),
#       plot.title = element_text(hjust = 0.5))

```

